name: Test

concurrency:
  group: ${{ github.workflow }}-${{ github.head_ref || github.run_id }}
  cancel-in-progress: true

on:
  pull_request:

  push:
    branches:
      - "master"
      - "next"

  workflow_dispatch:

jobs:
  execute_notebooks:
    name: Execute notebooks
    runs-on: ubuntu-24.04
    steps:
    - uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8 # v5.0.0
      with:
        path: freud-examples
    - name: Create Python Environment
      uses: prefix-dev/setup-pixi@fef5c9568ca6c4ff7707bf840ab0692ba3f08293 # v0.9.0
      with:
        pixi-version: v0.54.1
        cache: false
        activate-environment: true
        manifest-path: freud-examples/pixi.toml
    - name: Display freud version
      run: |-
        python3 -c "import freud; print(freud.__version__)"
    # clone the tutorials and run them
    - name: List notebooks
      run: ls **/*.ipynb
      working-directory: freud-examples
    - name: Execute notebooks
      run: |
        for i in examples module_intros
        do
          echo "Running notebooks in: $i" && jupyter nbconvert --execute --inplace $i/*.ipynb || exit 1
        done
      working-directory: freud-examples
